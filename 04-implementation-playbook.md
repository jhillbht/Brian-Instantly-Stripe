# Implementation Playbook - Instantly + Stripe Workflows

## Quick Start Checklist

### Prerequisites Verification
- [ ] Macbook M1 Pro setup confirmed (supabowl machine)
- [ ] Claude Desktop installed and configured
- [ ] Cursor IDE installed and configured
- [ ] Instantly account active with API access
- [ ] Stripe account active with test/live API keys
- [ ] Node.js 18+ installed
- [ ] Git configured for repositories

### Initial Setup
- [ ] MCP servers cloned and installed
- [ ] Environment variables configured
- [ ] Claude Desktop MCP configuration updated
- [ ] Test connections to both APIs successful
- [ ] Basic webhook endpoints configured

## Workflow 1: Lead Nurturing to Sale

### Step 1: Set Up Base Campaign in Instantly

**Claude Desktop Commands:**
```
Create a new Instantly campaign called "Q1 2025 Lead Nurturing"
Set up a 5-email sequence over 14 days with these themes:
1. Welcome and value proposition
2. Problem identification 
3. Solution demonstration
4. Social proof and testimonials
5. Call to action with payment option
```

**Expected Response**: Campaign ID and sequence templates created

### Step 2: Create Stripe Products and Pricing

**Claude Desktop Commands:**
```
Create a Stripe product called "Premium Consultation Package"
Set up pricing tiers:
- Basic: $297 one-time payment
- Premium: $597 one-time payment  
- Enterprise: $1,497 one-time payment

Generate payment links for each tier
```

**Expected Response**: Product IDs and payment links generated

### Step 3: Import and Segment Leads

**Manual Task in Instantly:**
1. Export leads from your CRM/source
2. Format as CSV with required fields: email, first_name, last_name, company
3. Import to Instantly campaign

**Claude Desktop Commands:**
```
Import leads from CSV file to the Q1 2025 campaign
Segment leads by company size:
- Small (1-50 employees) → Basic tier
- Medium (51-200 employees) → Premium tier  
- Large (200+ employees) → Enterprise tier
```

### Step 4: Set Up Engagement Triggers

**Integration Logic (Claude Commands):**
```
Set up automation rules:
- If lead opens 3+ emails → create Stripe customer profile
- If lead clicks any link → generate personalized payment link
- If lead replies with interest → send premium tier payment link
- If payment completed → add to "Customer Onboarding" sequence
```

### Step 5: Launch and Monitor

**Launch Commands:**
```
Start the Q1 2025 Lead Nurturing campaign
Set up monitoring for:
- Email open rates
- Click-through rates  
- Stripe customer creation rate
- Payment conversion rate
```

**Monitoring Dashboard Request:**
```
Create a daily report showing:
- Emails sent vs opened vs clicked
- Stripe customers created
- Payments processed
- Revenue generated by email sequence
```

## Workflow 2: Product Launch Campaign

### Step 1: Product Setup in Stripe

**Claude Desktop Commands:**
```
Create new Stripe product "AI Automation Course"
Set up early bird pricing:
- Early Bird (first 100 customers): $197
- Regular Price: $297
- VIP Package: $497 (includes 1-on-1 session)

Create payment links with quantity limits for early bird
```

### Step 2: Audience Segmentation in Instantly

**Segmentation Strategy:**
```
Create Instantly segments based on:
- Previous engagement level (high/medium/low)
- Industry vertical (tech, marketing, consulting)
- Company size (startup, SMB, enterprise)
- Purchase history (paying customer, prospect, cold lead)
```

**Claude Commands:**
```
Create 4 different email sequences for product launch:
1. "VIP Customers" - immediate access offer
2. "High Engagement Prospects" - early bird pricing
3. "Medium Engagement" - standard launch sequence
4. "Cold Leads" - value-building sequence before offer
```

### Step 3: Automated Launch Sequence

**Timeline and Automation:**

**Week 1 - Teaser Campaign:**
```
Day 1: "Something big is coming" - VIP list only
Day 3: "Sneak peek inside" - High engagement prospects  
Day 5: "Early access opens Monday" - All segments
```

**Week 2 - Launch Week:**
```
Day 8: "Early bird is live" - Generate payment links
Day 10: "48 hours left for early bird pricing"
Day 12: "Last chance for early bird"
Day 14: "Early bird expired, regular pricing begins"
```

**Claude Automation Setup:**
```
Configure automatic triggers:
- VIP customers → VIP payment link immediately
- High engagement → Early bird payment link on Day 8
- Medium engagement → Regular payment link on Day 14
- Payment completed → Send course access + onboarding sequence
```

### Step 4: Real-time Optimization

**A/B Testing Setup:**
```
Test different subject lines for launch emails:
- Version A: "Your AI Automation Course is Ready"
- Version B: "Stop Doing Manual Work (This Changes Everything)"

Test different payment page messaging:
- Version A: Feature-focused copy
- Version B: Benefit-focused copy
```

**Performance Monitoring:**
```
Track metrics by segment:
- Open rates by audience segment
- Click-to-payment-page rate
- Payment page conversion rate
- Revenue per email sent
```

## Workflow 3: Subscription Business Automation

### Step 1: Stripe Subscription Setup

**Claude Desktop Commands:**
```
Create subscription products in Stripe:
- Basic Plan: $29/month 
- Pro Plan: $79/month
- Enterprise Plan: $199/month

Set up trial periods:
- 14-day free trial for all plans
- Proration handling for upgrades/downgrades
```

### Step 2: Onboarding Email Sequences

**New Subscriber Sequence:**
```
Create Instantly sequence "New Subscriber Onboarding":
Day 0: Welcome email with login credentials
Day 1: "How to get started" tutorial
Day 3: "Quick wins in your first week"
Day 7: "Getting the most from [Product]"
Day 14: "Your trial expires tomorrow" (if still in trial)
```

**Claude Setup Commands:**
```
Configure subscription status triggers:
- Trial started → Add to "Trial Onboarding" sequence
- Trial ending (2 days before) → Send "Convert to Paid" sequence
- Subscription activated → Move to "Active Customer" sequence
- Payment failed → Add to "Payment Recovery" sequence
```

### Step 3: Retention and Upsell Automation

**Churn Prevention:**
```
Set up automated sequences for:
- Low usage detection → "Getting more value" email series
- 30 days before renewal → "Year-end review" with upgrade offer
- Cancellation attempt → "Win-back" sequence with discount
```

**Upsell Automation:**
```
Create usage-based triggers:
- Basic plan hitting limits → Pro plan upgrade offer
- Pro plan heavy usage → Enterprise plan consultation offer
- Feature requests → "This is available in higher tier" emails
```

### Step 4: Payment Recovery System

**Failed Payment Sequence:**
```
Automated recovery emails:
Day 0: "Payment failed - please update your card"
Day 3: "Your subscription is paused - quick fix needed"  
Day 7: "Final notice - subscription will cancel in 24 hours"
Day 8: "Subscription cancelled - special win-back offer"
```

**Claude Integration Commands:**
```
Set up Stripe webhook handling:
- invoice.payment_failed → Trigger payment recovery sequence
- invoice.payment_succeeded → Remove from recovery, add to success sequence
- customer.subscription.deleted → Move to win-back sequence
```

## Advanced Integration Patterns

### Pattern 1: Revenue Attribution Tracking

**Setup Commands:**
```
Create UTM tracking for all email links:
- Source: instantly
- Medium: email
- Campaign: [campaign_name]
- Content: [email_sequence_position]

Set up Stripe metadata to capture:
- Original Instantly campaign ID
- Email sequence that led to conversion
- Days from first email to purchase
- Total emails opened before purchase
```

**Attribution Analysis:**
```
Generate monthly attribution reports:
- Revenue by Instantly campaign
- Best performing email sequences
- Average time from lead to customer
- Customer lifetime value by acquisition campaign
```

### Pattern 2: Dynamic Personalization

**Advanced Personalization Setup:**
```
Use Stripe customer data to personalize Instantly emails:
- Previous purchase history → Relevant upsell offers
- Subscription tier → Tier-appropriate content
- Payment history → Payment reliability messaging
- Usage patterns → Feature-specific tutorials
```

**Implementation:**
```
Create dynamic email content blocks:
- {{customer.tier}} → "As a [Pro] subscriber..."
- {{customer.usage}} → "Since you've been actively using [feature]..."
- {{customer.payment_history}} → Custom offers based on payment reliability
```

### Pattern 3: Customer Journey Orchestration

**Cross-Platform Journey Mapping:**
```
Define customer states:
1. Cold Lead (Instantly only)
2. Engaged Prospect (Instantly + Stripe customer profile)
3. Trial User (Stripe trial + Instantly onboarding)
4. Paying Customer (Stripe active + Instantly customer success)
5. Churned Customer (Stripe cancelled + Instantly win-back)
```

**State Transition Automation:**
```
Set up automatic state transitions:
- Email engagement threshold → Create Stripe customer
- Stripe trial started → Move to trial onboarding sequence
- Payment successful → Move to customer success sequence
- Subscription cancelled → Move to win-back sequence
```

## Troubleshooting Guide

### Common Issues and Solutions

**Issue: MCP Server Connection Failed**
```
Solution steps:
1. Check Claude Desktop configuration file
2. Verify MCP server is running: `ps aux | grep node`
3. Test API connections: `curl [API_ENDPOINT]`
4. Check environment variables: `echo $INSTANTLY_API_KEY`
5. Restart Claude Desktop completely
```

**Issue: Webhook Not Firing**
```
Solution steps:
1. Verify webhook URL is accessible: `curl [WEBHOOK_URL]`
2. Check webhook signature validation
3. Review Stripe webhook logs in dashboard
4. Test with Stripe CLI: `stripe listen --forward-to localhost:3000/webhook`
5. Validate webhook endpoint in Stripe dashboard
```

**Issue: Data Sync Problems**
```
Solution steps:
1. Check API rate limits for both services
2. Verify data mapping functions
3. Review error logs for failed sync attempts
4. Test with single record first
5. Implement retry logic for failed syncs
```

### Performance Optimization

**API Rate Limit Management:**
```
Implement queuing system:
- Instantly: 120 requests/minute
- Stripe: 100 requests/second (test), 1000/second (live)
- Use exponential backoff for retries
- Batch operations where possible
```

**Database Optimization:**
```
Index frequently queried fields:
- email addresses (unique index)
- campaign IDs (composite index)
- customer IDs (foreign key index)
- timestamps (for date range queries)
```

## Success Metrics and KPIs

### Email Performance Metrics
- **Open Rate**: Target 25-35% for cold outreach, 45-55% for warm lists
- **Click Rate**: Target 3-5% for cold outreach, 8-12% for warm lists
- **Reply Rate**: Target 1-3% for cold outreach, 5-8% for warm lists

### Conversion Metrics
- **Email to Customer**: Target 0.5-2% for cold campaigns
- **Customer to Paying**: Target 10-25% depending on price point
- **Overall Email to Revenue**: Target $0.10-$1.00 per email sent

### Revenue Metrics
- **Revenue per Email**: Calculate monthly to optimize campaigns
- **Customer Acquisition Cost**: Include email marketing costs
- **Customer Lifetime Value**: Track by acquisition channel
- **Payback Period**: Time to recover acquisition costs

### Operational Metrics
- **API Response Time**: < 500ms for all MCP operations
- **Webhook Processing Time**: < 2 seconds for all events
- **Data Sync Accuracy**: > 99% success rate
- **System Uptime**: > 99.5% availability

## Next Steps and Roadmap

### Phase 1: Basic Integration (Week 1-2)
- [ ] Complete MCP server setup
- [ ] Test basic API connections
- [ ] Implement simple lead-to-customer workflow
- [ ] Set up basic monitoring

### Phase 2: Advanced Automation (Week 3-4)
- [ ] Implement webhook handlers
- [ ] Set up automated sequences
- [ ] Add revenue attribution tracking
- [ ] Create performance dashboards

### Phase 3: Optimization (Week 5-6)
- [ ] A/B testing implementation
- [ ] Advanced personalization
- [ ] Predictive analytics
- [ ] Machine learning insights

### Phase 4: Scale (Week 7-8)
- [ ] Production deployment
- [ ] Performance optimization
- [ ] Security hardening
- [ ] Documentation and training

## Support and Resources

### Documentation Links
- [Instantly API Documentation](https://instantly.ai/docs)
- [Stripe API Documentation](https://stripe.com/docs/api)
- [Claude MCP Documentation](https://docs.anthropic.com/claude/docs)

### Community Resources
- Instantly Community Forum
- Stripe Developer Discord
- Claude AI Community

### Emergency Contacts
- **API Issues**: Support teams for respective platforms
- **Integration Issues**: Development team
- **Business Impact**: Stakeholder notification list